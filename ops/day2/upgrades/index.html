
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A workshop for Operations and Development teams on ARO.">
      
      
        <meta name="author" content="Red Hat">
      
      
        <link rel="canonical" href="https://ws.verynicecluster.cloud/ops/day2/upgrades/">
      
      <link rel="icon" href="../../../favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.9">
    
    
      
        <title>Managing Upgrades - ARO Workshop</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.08040f6c.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Overpass:300,300i,400,400i,700,700i%7COverpass+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Overpass";--md-code-font:"Overpass Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="red">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ARO Workshop" class="md-header__button md-logo" aria-label="ARO Workshop" data-md-component="logo">
      
  <img src="../../../favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ARO Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Managing Upgrades
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bizquigs/aro-workshop-content" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bizquigs/aro-hackathon-content
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ARO Workshop" class="md-nav__button md-logo" aria-label="ARO Workshop" data-md-component="logo">
      
  <img src="../../../favicon.ico" alt="logo">

    </a>
    ARO Workshop
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bizquigs/aro-workshop-content" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    bizquigs/aro-hackathon-content
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Workshop Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Workshop Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Workshop Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../general/1-workshop-setup/" class="md-nav__link">
        Azure portal and CLI setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-3-get-credentials/" class="md-nav__link">
        Retieve ARO Cluster Credentials
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Prepare the Cluster and Evironment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Prepare the Cluster and Evironment" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Prepare the Cluster and Evironment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3-deploy-azure-service-operator/" class="md-nav__link">
        Azure Service Operator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-5-deploy-cosmos/" class="md-nav__link">
        Deploy Cosmos Database
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Managing Worker Nodes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Managing Worker Nodes" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Managing Worker Nodes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-4-label-nodes/" class="md-nav__link">
        Label Nodes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Deploy an Application
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deploy an Application" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Deploy an Application
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../app/2-1-deploy-frontend/" class="md-nav__link">
        Deploy the frontend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../app/2-2-deploy-backend/" class="md-nav__link">
        Deploy the backend
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Make the application resilent
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Make the application resilent" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Make the application resilent
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-3-autoscaling.md" class="md-nav__link">
        Setup cluster autoscaling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../app/3-scale-app/" class="md-nav__link">
        Make Applications Resilient
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          ARO Day X Operations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ARO Day X Operations" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          ARO Day X Operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Managing Upgrades
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Managing Upgrades
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrade-using-the-openshift-web-console" class="md-nav__link">
    Upgrade using the OpenShift Web Console
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrade-using-the-managed-upgrade-operator" class="md-nav__link">
    Upgrade using the Managed Upgrade Operator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-first-lets-check-for-available-upgrades-on-your-current-upgrade-channel-to-do-so-run-the-following-command" class="md-nav__link">
    1. First, let's check for available upgrades on your current upgrade channel. To do so, run the following command:
  </a>
  
    <nav class="md-nav" aria-label="1. First, let's check for available upgrades on your current upgrade channel. To do so, run the following command:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enable-the-managed-upgrade-operator" class="md-nav__link">
    Enable the Managed Upgrade Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-the-managed-upgrade-operator" class="md-nav__link">
    Configure the Managed Upgrade Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedule-an-upgrade" class="md-nav__link">
    Schedule an Upgrade
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrade-using-the-openshift-web-console" class="md-nav__link">
    Upgrade using the OpenShift Web Console
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrade-using-the-managed-upgrade-operator" class="md-nav__link">
    Upgrade using the Managed Upgrade Operator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-first-lets-check-for-available-upgrades-on-your-current-upgrade-channel-to-do-so-run-the-following-command" class="md-nav__link">
    1. First, let's check for available upgrades on your current upgrade channel. To do so, run the following command:
  </a>
  
    <nav class="md-nav" aria-label="1. First, let's check for available upgrades on your current upgrade channel. To do so, run the following command:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enable-the-managed-upgrade-operator" class="md-nav__link">
    Enable the Managed Upgrade Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-the-managed-upgrade-operator" class="md-nav__link">
    Configure the Managed Upgrade Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedule-an-upgrade" class="md-nav__link">
    Schedule an Upgrade
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/bizquigs/aro-workshop-content/edit/master/docs/ops/day2/upgrades.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">#</a></h2>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:aro-content/ops/day2/upgrades.md</p>
<p>Azure Red Hat OpenShift (ARO) provides fully-managed cluster updates. These updates can be triggered from inside the OpenShift Console, or scheduled in advance by utilizing the Managed Upgrade Operator. All updates are monitored and managed by the Red Hat and Microsoft ARO SRE team.</p>
<p>For more information on how OpenShift's Upgrade Service works, please see the <a href="https://docs.openshift.com/container-platform/4.10/updating/index.html" target="_blank">Red Hat documentation</a>.</p>
<h2 id="upgrade-using-the-openshift-web-console">Upgrade using the OpenShift Web Console<a class="headerlink" href="#upgrade-using-the-openshift-web-console" title="Permanent link">#</a></h2>
<ol>
<li>
<p>Return to your tab with the OpenShift Web Console. If you need to reauthenticate, follow the steps in the <a href="../setup/3-access-cluster/">Access Your Cluster</a> section.</p>
</li>
<li>
<p>Using the menu on the left Select <em>Administration</em> -&gt; <em>Cluster Settings</em>.</p>
<p><img align="center" alt="Web Console - Cluster Settings" src="/assets/images/web-console-cluster-settings.png" /></p>
</li>
<li>
<p>Click on the <em>Not Configured</em> link under the <em>Upgrade Channel</em> heading.</p>
<p><img align="center" alt="Web Console - Upgrade Channel Not Configured" src="/assets/images/web-console-upgrade-channel-not-configured.png" /></p>
<div class="admonition warning">
<p class="admonition-title">Upgrade channel is not configured by default</p>
<p>By default, the <a href="https://docs.openshift.com/container-platform/4.10/updating/understanding-upgrade-channels-release.html" target="_blank">upgrade channel</a> (which is used to recommend the appropriate release versions for cluster updates), is not set in ARO.</p>
</div>
</li>
<li>
<p>In the <em>Channel</em> field, enter <code>stable-4.10</code> to set the upgrade channel to the stable releases of OpenShift 4.10 and click <em>Save</em>.</p>
<p><img align="center" alt="Web Console - Input Channel" src="/assets/images/web-console-input-channel.png" /></p>
</li>
<li>
<p>In a moment, you'll begin to see what upgrades are available for your cluster. From here, you could click the <em>Select a version</em> button and upgrade the cluster, or you could follow the instructions below to use the Managed Upgrade Operator.</p>
<p><img alt="Web Console - Available Upgrades" src="../../Images/aro-console-upgrade.png" /></p>
</li>
</ol>
<h2 id="upgrade-using-the-managed-upgrade-operator">Upgrade using the Managed Upgrade Operator<a class="headerlink" href="#upgrade-using-the-managed-upgrade-operator" title="Permanent link">#</a></h2>
<p>=======</p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>a78436f (initial v2):aro-content/ops/2-1-upgrades.md
The Managed Upgrade Operator has been created to manage the orchestration of automated in-place cluster upgrades.</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>Whilst the operator's job is to invoke a cluster upgrade, it does not perform any activities of the cluster upgrade process itself. This remains the responsibility of the OpenShift Container Platform. The operator's goal is to satisfy the operating conditions that a managed cluster must hold, both pre- and post-invocation of the cluster upgrade.</p>
<p>Examples of activities that are not core to an OpenShift upgrade process but could be handled by the operator include:</p>
<ul>
<li>Pre and post-upgrade health checks.</li>
<li>Worker capacity scaling during the upgrade period.</li>
<li>Alerting silence window management.</li>
</ul>
<p>Configuring the Managed Upgrade Operator for ARO ensures that your cluster functions as you need it to during upgrades. The process of executing upgrades is shown here:</p>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:aro-content/ops/day2/upgrades.md
<img alt="MUO Upgrade Process Flow Chart" src="/assets/images/upgradecluster-flow.svg" /></p>
<h1 id="1-first-lets-check-for-available-upgrades-on-your-current-upgrade-channel-to-do-so-run-the-following-command">1. First, let's check for available upgrades on your current upgrade channel. To do so, run the following command:<a class="headerlink" href="#1-first-lets-check-for-available-upgrades-on-your-current-upgrade-channel-to-do-so-run-the-following-command" title="Permanent link">#</a></h1>
<p><img alt="MUO Upgrade Process" src="../assets/images/upgradecluster-flow.svg" /></p>
<h3 id="enable-the-managed-upgrade-operator">Enable the Managed Upgrade Operator<a class="headerlink" href="#enable-the-managed-upgrade-operator" title="Permanent link">#</a></h3>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>a78436f (initial v2):aro-content/ops/2-1-upgrades.md</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>Run this oc command to enable the Managed Upgrade Operator (MUO)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>oc patch cluster.aro.openshift.io cluster --patch \
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a> &#39;{&quot;spec&quot;:{&quot;operatorflags&quot;:{&quot;rh.srep.muo.enabled&quot;: &quot;true&quot;,&quot;rh.srep.muo.managed&quot;: &quot;true&quot;,&quot;rh.srep.muo.deploy.pullspec&quot;:&quot;arosvc.azurecr.io/managed-upgrade-operator@sha256:f57615aa690580a12c1e5031ad7ea674ce249c3d0f54e6dc4d070e42a9c9a274&quot;}}}&#39; \
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a> --type=merge
</code></pre></div>
<p>Wait a few moments to ensure the Management Upgrade Operator is ready, the status of the operator can be verified with:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>oc -n openshift-managed-upgrade-operator <span class="se">\</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  get deployment managed-upgrade-operator
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>NAME                       READY   UP-TO-DATE   AVAILABLE   AGE
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>managed-upgrade-operator   1/1     1            1           2m2s
</code></pre></div></p>
<h3 id="configure-the-managed-upgrade-operator">Configure the Managed Upgrade Operator<a class="headerlink" href="#configure-the-managed-upgrade-operator" title="Permanent link">#</a></h3>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:aro-content/ops/day2/upgrades.md
1. Once created, we can see that the update is pending by running the following command:
=======
Next, configure the Managed Upgrade Operator by using the following YAML:</p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>a78436f (initial v2):aro-content/ops/2-1-upgrades.md</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<div class="highlight"><span class="filename">muo-config-map.yaml</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>apiVersion: v1
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>kind: ConfigMap
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>metadata:
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  name: managed-upgrade-operator-config
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>  namespace:  openshift-managed-upgrade-operator
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>data:
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>  config.yaml: |
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    configManager:
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>      source: LOCAL
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>      localConfigName: managed-upgrade-config
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>      watchInterval: 1
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    maintenance:
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>      controlPlaneTime: 90
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>      ignoredAlerts:
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>        controlPlaneCriticals:
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>        - ClusterOperatorDown
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>        - ClusterOperatorDegraded
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>    upgradeWindow:
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>      delayTrigger: 30
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>      timeOut: 120
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>    nodeDrain:
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>      timeOut: 45
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>      expectedNodeDrainTime: 8
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>    scale:
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>      timeOut: 30
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>    healthCheck:
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>      ignoredCriticals:
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>      - PrometheusRuleFailures
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>      - CannotRetrieveUpdates
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>      - FluentdNodeDown
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>      ignoredNamespaces:
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>      - openshift-logging
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>      - openshift-redhat-marketplace
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>      - openshift-operators
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>      - openshift-user-workload-monitoring
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>      - openshift-pipelines
</code></pre></div>
<p>You can apply the ConfigMap with this command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>oc apply -f https://rh-mobb.github.io/aro-hackathon-content/assets/muo-config-map.yaml
</code></pre></div>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:aro-content/ops/day2/upgrades.md
    Congratulations! You've successfully scheduled an upgrade of your cluster for tomorrow at this time. While the workshop environment will be deleted before then, you now have the experience to schedule upgrades in the future.
=======
Restart the Managed Upgrade Operator</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>oc -n openshift-managed-upgrade-operator \
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>  scale deployment managed-upgrade-operator --replicas=0
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>oc -n openshift-managed-upgrade-operator \
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>  scale deployment managed-upgrade-operator --replicas=1
</code></pre></div>
<p>Look for available Upgrades</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If the output is <code>nil</code> there are no available upgrades and you cannot continue.</p>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>oc get clusterversion version -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.availableUpdates}&#39;</span>
</code></pre></div>
<h3 id="schedule-an-upgrade">Schedule an Upgrade<a class="headerlink" href="#schedule-an-upgrade" title="Permanent link">#</a></h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Set the Channel and Version in the UpgradeConfig file to the desired values from the above list of available upgrades.</p>
</div>
<p>The configuration below will schedule an upgrade for the current date / time + 5 minutes, allow PDB-blocked nodes to drain for 60 minutes before a drain is forced, and sets a capacity reservation so that workloads are not interrupted during an upgrade.</p>
<div class="highlight"><span class="filename">muo-upgrade-config.yaml</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>apiVersion: upgrade.managed.openshift.io/v1alpha1
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>kind: UpgradeConfig
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>metadata:
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>  name: managed-upgrade-config
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>  namespace: openshift-managed-upgrade-operator
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>spec:
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>  type: &quot;ARO&quot;
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>  upgradeAt: $(date -u --iso-8601=seconds --date &quot;+5 minutes&quot;)
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>  PDBForceDrainTimeout: 60
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>  capacityReservation: true
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>  desired:
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>    channel: &quot;stable-4.10&quot;
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>    version: &quot;4.10.28&quot;
</code></pre></div>
<p>To apply the UpgradeConfig you can run the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>oc apply -f https://rh-mobb.github.io/aro-hackathon-content/assets/muo-upgrade-config.yaml
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the cluster is on the latest version, the upgrade will not apply.</p>
</div>
<p>Check the status of the scheduled upgrade</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>c -n openshift-managed-upgrade-operator get <span class="se">\</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a> upgradeconfigs.upgrade.managed.openshift.io <span class="se">\</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a> managed-upgrade-config -o <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status}&#39;</span> <span class="p">|</span> jq
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The output of this command should show upgrades in progress</p>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="p">{</span><span class="w"></span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nt">&quot;history&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">      </span><span class="p">{</span><span class="w"></span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">        </span><span class="nt">&quot;lastProbeTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2022-04-12T14:42:02Z&quot;</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">        </span><span class="nt">&quot;lastTransitionTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2022-04-12T14:16:44Z&quot;</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">        </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ControlPlaneUpgraded still in progress&quot;</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">        </span><span class="nt">&quot;reason&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ControlPlaneUpgraded not done&quot;</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">        </span><span class="nt">&quot;startTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2022-04-12T14:16:44Z&quot;</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">        </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;False&quot;</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ControlPlaneUpgraded&quot;</span><span class="w"></span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">      </span><span class="p">},</span><span class="w"></span>
</code></pre></div>
<p>You can verify the upgrade has completed successfully via the following</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>oc get clusterversion version
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>NAME      VERSION   AVAILABLE   PROGRESSING   SINCE   STATUS
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>version   <span class="m">4</span>.9.27    True        False         161m    Cluster version is <span class="m">4</span>.9.27
</code></pre></div>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>a78436f (initial v2):aro-content/ops/2-1-upgrades.md</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../../app/3-scale-app/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Make Applications Resilient" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Make Applications Resilient
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate"], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>